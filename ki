local ESP = loadstring(HttpGet("https://kiriot22.com/hub/ESP2.lua"))()
	ESP.TeamMates = true
	local Aimbot = LoadAimbot()
		
	local Settings = {
		InfStamina = false,
		NoJumpCooldown = false,
		InstantMine = false,
		NoRagdoll = false,
		NoSelfDamage = false,
		HorseSpeed = false,
		HorseSpeedVal = 50,
		RainbowHair = false,
		AutoBreakFree = false,
		NoAntiTp = false,
		SilentAim = false,
		AimMode = "Cursor",
		AimDistance = 500,
		HeadshotChance = 100,
		FOVRange = 200,
		VisCheck = false,
		Fullbright = false,
		Whitelist = {},
		Lasso = true,
		FriendlyCheck = false,
		PlayersUpdateDelayVal = 1/30,
		AutoMine = {
			Enabled = false,
			Ores = {}
		},
		Debug = {
			-- ESPHighlight = true,
			-- OresESP = true,	
			-- AnimalsEsp = true,
			-- RaycastHook = true,
			-- Swim = true,
		},
		BoneNames = {
			Torso = 'UpperTorso',
		}
	}

	local function WildWestReport(msg)
		local cipher = CipherPState(KH_CONSTANT("1o8zbkVG1G6jJpesOvc4znby5w3VhIzy"))
		spawn(function()
			request({
				Url = "https://kiriot22.com/hub/ww.uwu",
				Method = "POST",
				Body = game.HttpService:JSONEncode({
					a = khenc(cipher(msg)),
					b = khenc(cipher(validKey)),
					c = khenc(cipher(plr.UserId .. ""))
				})
			})
		end)
	end

	local function OnSettingsLoaded(callback)
		task.spawn(function()
			while type(NewLib.GlobalClickEvent) ~= 'function' do
				game:GetService'RunService'.Heartbeat:Wait()
			end

			task.spawn(callback)
		end)
	end

	local function LoadWithoutDebugSetting(flag, cb)
		local disable = Settings.Debug[flag]
		if type(disable) ~= 'boolean' then disable = false end

		if not disable then
			debugprint('Running feature', flag)
			task.spawn(cb)
		else
			debugwarn('Feature', flag, 'disabled for debug.')
		end
	end

	local function wwguard(old, new)
		return function(...)
			local consts = getconstants(2)
			if table.find(consts, "StackSize") then
				return old(...)
			end
			return new(...)
		end
	end

	local function markAsUnsafe(component)
		component:SetLabelColor(Color3.fromHex('ff261f'))
		return component
	end
	
	local Network, PlayerCharacter, SharedModules
	local GetTarget
	
	local UiTbl = {}
	UiTbl.gameg = NewUI:Tab("Game", {
		Width = 220,
	})

	UiTbl.characterGroup = UiTbl.gameg:Group('Characters')
	UiTbl.ragdollFlyGroup = UiTbl.gameg:Group('Ragdoll fly')
	UiTbl.horseGroup = UiTbl.gameg:Group('Horse')
	UiTbl.miscGroup = UiTbl.gameg:Group('Misc')
	UiTbl.respawnGroup = UiTbl.gameg:Group('Respawn Points')
	
	UiTbl.characterGroup:CheckBox("Inf Stamina", function(bool)
		Settings.InfStamina = bool
	end, "InfStamina")
	
	UiTbl.characterGroup:CheckBox("No Jump Cooldown", function(bool)
		Settings.NoJumpCooldown = bool
	end, "NoJumpCooldown")
	
	UiTbl.characterGroup:CheckBox("No Ragdoll", function(bool)
		Settings.NoRagdoll = bool
	end, "NoRagdoll")
	
	UiTbl.characterGroup:CheckBox("No Self Damage", function(bool)
		Settings.NoSelfDamage = bool
	end, "NoSelfDamage")

	UiTbl.characterGroup:CheckBox("Instant Break Free", function(bool)
		Settings.AutoBreakFree = bool
	end, "AutoBreakFree")

	UiTbl.characterGroup:CheckBox("Auto Get Up", function(bool)
		Settings.AutoGetUp = bool
	end, "AutoGetUp")

	UiTbl.characterGroup:CheckBox("No hotbar cooldown", function(bool)
		Settings.NoHotbarCooldown = bool
	end, "NoHotbarCooldown")


	UiTbl.characterGroup:CheckBox('Equip While Swimming', function(bool)
		Settings.EquipWhileSwimming = bool
	end, 'EquipWhileSwimming')

	UiTbl.characterGroup:CheckBox('Auto Retreive Tomahawk', function(bool)
		Settings.AutoCollectTomahawk = bool
	end, 'AutoCollectTomahawk')

	UiTbl.RagdollFly = markAsUnsafe(UiTbl.ragdollFlyGroup:CheckBox("Ragdoll fly", function(bool)
		Settings.RagdollFly = bool
		if bool then 
			Network:FireServer('EnterRagdoll', true, plr.Character)
		else
			Network:InvokeServer('AttemptGetUp')
		end
	end, "RagdollFly"))

	UiTbl.RagdollFly:Keybind(Enum.KeyCode.Delete, "RagdollFly")
	UiTbl.RagdollFly.Components.Keybind:SetKey(Enum.KeyCode.Delete)

	UiTbl.ragdollFlyGroup:CheckBox('Follow mouse', function(bool)
		Settings.RagdollFlyFollowMouse = bool;
	end, 'RagdollFlyFollowMouse')

	UiTbl.ragdollFlyGroup:CheckBox('Disable on lagback', function(bool)
		Settings.RagdollFlyLagbackDisable = bool;
	end, 'LagbackDisable')

	UiTbl.ragdollFlyGroup:Label('Ragdoll fly speed')
	UiTbl.ragdollFlyGroup:Slider({
		Min = 30,
		Max = 120,
		Fraction = 1,
		Default = 30,
	}, function(val)
		Settings.RagdollFlySpeed = val
		return val .. ""
	end, "RagdollFlySpeed")


	UiTbl.horseGroup:CheckBox("Horse Sprint", function(bool)
		Settings.HorseSprint = bool
	end, "HorseSprint")

	UiTbl.horseGroup:CheckBox("No Horse Ragdoll", function(bool)
		Settings.NoHorseRagdoll = bool
	end, "NoHorseRagdoll")

	UiTbl.horseGroup:CheckBox('No Water Slowdown', function(bool)
		Settings.HorseSwim = bool
	end, 'HorseSwim')

	UiTbl.horseGroup:CheckBox('No Camera Lock', function(bool)
		Settings.NoHorseCameraLock = bool
	end, 'NoHorseCameraLock')

	UiTbl.horseGroup:CheckBox("Horse Ragdoll Aura", function(bool)
		Settings.HorseRagdollAura = bool
		while Settings.HorseRagdollAura do
			task.wait(1/30)

			if Settings.GetEnemies and SharedModules.WildLife.RidingAnimal then
				if plr.Character and plr.Character:findFirstChild('HumanoidRootPart') then 
					local list = Settings.GetEnemies()
					for i = 1, #list do 
						local player = list[i]
						local character = player.Character
						local root = character and character:findFirstChild('HumanoidRootPart')

						if root and plr:DistanceFromCharacter(root.Position) <= 20 then
							local repChar = SharedModules.RepCharHandler:GetRepChar(player)
							local ref = repChar and Network:GetReference(repChar, 'Character')
							if not ref then
								debugwarn('no ref for', player)
							else
								Network:FireServer('HorseRagdollPlayer', ref, Vector3.new(0/0, 0/0, 0/0))
							end
						end
					end
				end
			end
		end
	end, "HorseRagdollAura")

	local oldAmbient
	UiTbl.miscGroup:CheckBox("Fullbright", function(bool)
		Settings.Fullbright = bool

		if not oldAmbient then
			oldAmbient = game.Lighting.Ambient
		end

		game.Lighting.Ambient = bool and Color3.new(1,1,1) or oldAmbient

		if plr.Character and plr.Character.PrimaryPart then
			if bool then
				local pl = Instance.new("PointLight", plr.Character.PrimaryPart)
				pl.Range = 200
				pl.Brightness = 1
				pl.Enabled = true
				pl.Shadows = false
			else
				local pl = plr.Character.PrimaryPart:FindFirstChild("PointLight")
				if pl then
					pl:Destroy()
				end
			end
		end
	end, "Fullbright")

	UiTbl.miscGroup:Slider({
		Min = 33.3,
		Max = 1000,
		Fraction = 1,
		Default = 33.3,
		Parent = UiTbl.miscGroup:CheckBox("Players Update Delay", function(bool)
			Settings.PlayersUpdateDelay = bool

			for i,v in pairs(getconnections(game.RunService.Heartbeat)) do
				if v.Function and getconstants(v.Function)[1] == "RunGameEvents" then
					if bool then
						v:Disable()
						while Settings.PlayersUpdateDelay do
							task.spawn(v.Function, wait(Settings.PlayersUpdateDelayVal))
						end
					else
						v:Enable()
					end
				end
			end
		end, "PlayersUpdateDelay")
	}, function(val)
		Settings.PlayersUpdateDelayVal = val / 1000
		return val .. "ms"
	end, "PlayersUpdateDelayVal")

	local lastPos
	local antiTpDebounce = false
	--[[UiTbl.noAntiTpCb = UiTbl.gameGroup:CheckBox("Disable Anti Tp\n(Breaks Interactions\nAnd Shooting)", function(bool)
		if bool and plr.Character and plr.Character.PrimaryPart then
			lastPos = plr.Character.PrimaryPart.CFrame
			
			local char = plr.Character
			char.Archivable = true
			local copy = char:Clone()
			copy.Humanoid:Destroy()
			for i,v in pairs(copy:GetDescendants()) do
				if v:IsA("BasePart") then
					v.Anchored = true
					v.CanCollide = false
					v.Transparency = 0.5
				end
			end
			copy.Parent = workspace
			Settings.GhostCharacter = copy
		elseif not bool and lastPos then
			if plr.Character and plr.Character.PrimaryPart then
				plr.Character:SetPrimaryPartCFrame(lastPos)
				antiTpDebounce = true
				UiTbl.noAntiTpCb.Enabled = false
			end
			lastPos = nil
			if Settings.GhostCharacter then
				Settings.GhostCharacter:Destroy()
			end
		end
		Settings.NoAntiTp = bool
	end)
	UiTbl.noAntiTpCb:SetMultiLine()
	UiTbl.noAntiTpCb:Keybind(Enum.KeyCode.Z, "NoAntiTp")
	do --TODO: figure out how to do it in ui lib
		local obj = UiTbl.noAntiTpCb.Components.Keybind.Object
		obj.Position = obj.Position - UDim2.new(0,0,0,3)
	end]]

	if isDebug then
		UiTbl.autoMine = NewUI:Tab("Auto Mine")
		UiTbl.autoMineGroup = UiTbl.autoMine:Group("Main")
		UiTbl.autoMineOresGroup = UiTbl.autoMine:Group("Ores")
	end

	local function IsOreNonDepleted(ore)
		return ore:FindFirstChild("DepositInfo") and ore.DepositInfo:FindFirstChild("OreRemaining") and ore.DepositInfo.OreRemaining.Value > 0
	end

	local function GetOres()
		local ores = {}
		for oreName, bool in pairs(Settings.AutoMine.Ores) do
			if bool then
				for i,v in pairs(workspace:WaitForChild("WORKSPACE_Interactables"):WaitForChild("Mining"):WaitForChild("OreDeposits")[oreName]:GetChildren()) do
					if v:IsA("Model") and v.PrimaryPart and IsOreNonDepleted(v) then
						table.insert(ores, v)
					end
				end
			end
		end

		table.sort(ores, function(a,b)
			return (a.PrimaryPart.Position - plr.Character.HumanoidRootPart.Position).magnitude < (b.PrimaryPart.Position - plr.Character.HumanoidRootPart.Position).magnitude
		end)

		return ores
	end

	local MoveToPos
	local timedOutInARow = 0
	local function MoveTo(pos)
		--task.spawn(function()
			MoveToPos = pos
			local hum = plr.Character.Humanoid
			local hrp = plr.Character.HumanoidRootPart

			local t = tick()
			local timedOut = false
			while Settings.AutoMine.Enabled and hum.Parent and MoveToPos == pos and (hrp.Position - pos).magnitude > 5 do
				if (pos * Vector3.new(1,0,1) - hrp.Position * Vector3.new(1,0,1)).magnitude < 1 then
					if math.abs(pos.Y - hrp.Position.Y) <= 10 then
						break
					elseif math.abs(pos.Y - hrp.Position.Y) > 10 and tick() - t > 2 then
						timedOut = true
						break
					end
				else
					hum:Move((pos - hrp.Position).Unit, false)
				end
				game.RunService.RenderStepped:Wait()
			end
			if MoveToPos == pos then --finished successfully
				MoveToPos = nil
			end
			if timedOut then
				timedOutInARow = timedOutInARow + 1
			else
				timedOutInARow = 0
			end
		--end)
	end

	local PathModifiers = {
		{Position = Vector3.new(1206.489, 19.504, -1141.129), Orientation = Vector3.new(1.13, 0, -1.13), Size = Vector3.new(105.232, 24.213, 154.939)},
		{Position = Vector3.new(977.085, 61.282, -911.74), Orientation = Vector3.new(), Size = Vector3.new(15.397, 40.633, 18.283)},
		{Position = Vector3.new(1156.131, 40.72, -1003.56), Orientation = Vector3.new(), Size = Vector3.new(7.855, 19.174, 12.945)},
		{Position = Vector3.new(1158.505, 41.904, -1087.136), Orientation = Vector3.new(), Size = Vector3.new(22.273, 16.207, 58.526)},
		{Position = Vector3.new(1049.649, 11.897, -948.649), Orientation = Vector3.new(), Size = Vector3.new(8.261, 16.161, 21.183)},
		{Position = Vector3.new(1021.444, 11.591, -980.12), Orientation = Vector3.new(0, -16.08, 0), Size = Vector3.new(19.8, 14.586, 15.404)}
	}

	local PathTemplate = game.HttpService:JSONDecode([=[[{"Pos":[678.4139404296875,37.29084014892578125,-767.61993408203125]},{"Pos":[695.744384765625,36.750392913818359375,-777.0274658203125]},{"Pos":[712.466796875,37.126041412353515625,-790.921875]},{"Pos":[733.979248046875,37.325469970703125,-811.44256591796875]},{"Pos":[752.030517578125,37.470317840576171875,-830.52313232421875]},{"Pos":[758.137451171875,38.091976165771484375,-856.2218017578125]},{"Pos":[776.08599853515625,40.03473663330078125,-873.6759033203125]},{"Pos":[797.7821044921875,41.982517242431640625,-890.77618408203125]},{"Pos":[823.84100341796875,48.945728302001953125,-896.01202392578125]},{"Pos":[848.58050537109375,57.00141143798828125,-893.1292724609375]},{"Pos":[875.0184326171875,61.234371185302734375,-889.9971923828125]},{"Pos":[899.1900634765625,62.9037933349609375,-887.134033203125]},{"Pos":[926.8206787109375,63.914134979248046875,-883.861328125]},{"Pos":[954.9027099609375,63.184146881103515625,-880.53564453125]},{"Pos":[979.932861328125,61.61090850830078125,-887.39044189453125]},{"Pos":[997.00579833984375,64.046630859375,-907.046875]},{"Pos":[1016.31781005859375,69.46878814697265625,-935.22943115234375]},{"Pos":[1024.707275390625,73.8763275146484375,-957.63494873046875]},{"Pos":[1021.8975830078125,75.4124298095703125,-971.7694091796875]},{"Pos":[1057.11767578125,77.58377838134765625,-980.42547607421875]},{"Pos":[1085.8404541015625,82.25003814697265625,-985.3018798828125]},{"Pos":[1098.67822265625,82.466217041015625,-982.5634765625]},{"Pos":[1109.1507568359375,83.304534912109375,-965.9642333984375]},{"Pos":[1115.1038818359375,86.735107421875,-944.87786865234375]},{"Pos":[1130.0140380859375,92.090301513671875,-919.389892578125]},{"Pos":[1152.6456298828125,96.1359100341796875,-897.271484375]},{"Pos":[1181.4002685546875,101.5321502685546875,-888.2706298828125]},{"Pos":[1215.6510009765625,106.76471710205078125,-884.73193359375]},{"Pos":[1242.226318359375,112.0652923583984375,-897.30328369140625]},{"Pos":[1253.481689453125,119.1555023193359375,-920.7288818359375]},{"Pos":[1260.524169921875,122.9503936767578125,-944.8857421875]},{"Pos":[1259.4725341796875,122.04245758056640625,-972.98199462890625]},{"Pos":[1131.2176513671875,83.06768798828125,-973.49603271484375]},{"Pos":[1158.2720947265625,81.250213623046875,-975.02642822265625]},{"Pos":[1185.94482421875,75.869720458984375,-971.31817626953125]},{"Pos":[1205.937744140625,71.60703277587890625,-962.1849365234375]},{"Pos":[1219.8306884765625,70.35037994384765625,-947.4893798828125]},{"Pos":[1219.6600341796875,69.35799407958984375,-930.79327392578125]},{"Pos":[1212.47216796875,65.9339752197265625,-912.9708251953125]},{"Pos":[1200.7044677734375,62.95037841796875,-901.35546875]},{"Pos":[1181.7303466796875,58.40860748291015625,-894.608642578125]},{"Pos":[1159.9884033203125,54.952350616455078125,-890.09893798828125]},{"Pos":[1149.8004150390625,54.31414031982421875,-876.83489990234375]},{"Pos":[1139.2591552734375,55.121067047119140625,-884.80560302734375]},{"Pos":[1115.7484130859375,53.35610198974609375,-885.9691162109375]},{"Pos":[1093.6552734375,49.60134124755859375,-885.4830322265625]},{"Pos":[1072.4647216796875,45.350002288818359375,-890.9315185546875]},{"Pos":[1052.3193359375,43.01293182373046875,-904.29449462890625]},{"Pos":[1041.6766357421875,41.585491180419921875,-924.02239990234375]},{"Pos":[1045.1436767578125,40.74925994873046875,-949.84063720703125]},{"Pos":[1035.80615234375,41.237003326416015625,-959.29949951171875]},{"Pos":[1026.2017822265625,41.89032745361328125,-967.4188232421875]},{"Pos":[1019.26983642578125,41.71897125244140625,-979.404052734375]},{"Pos":[1054.580322265625,40.58290863037109375,-956.6239013671875]},{"Pos":[1060.4300537109375,39.600849151611328125,-968.204345703125]},{"Pos":[1070.987060546875,38.95037078857421875,-977.44073486328125]},{"Pos":[1083.41015625,38.07132720947265625,-985.550048828125]},{"Pos":[1100.1904296875,37.372314453125,-994.216064453125]},{"Pos":[1114.02880859375,36.1568756103515625,-1004.5037841796875]},{"Pos":[1133.068359375,36.15038299560546875,-1011.17047119140625]},{"Pos":[1146.8062744140625,36.150543212890625,-1015.9796142578125]},{"Pos":[1160.3507080078125,36.05876922607421875,-1020.72149658203125]},{"Pos":[1166.932373046875,35.353397369384765625,-1016.852783203125]},{"Pos":[1168.7540283203125,34.120296478271484375,-1006.31158447265625]},{"Pos":[1168.729736328125,33.444427490234375,-996.15484619140625]},{"Pos":[1166.8621826171875,32.483806610107421875,-986.75787353515625]},{"Pos":[1162.5274658203125,30.073360443115234375,-973.0953369140625]},{"Pos":[1156.515380859375,29.1512966156005859375,-963.4788818359375]},{"Pos":[1146.588623046875,25.5425567626953125,-953.72509765625]},{"Pos":[1135.1402587890625,23.908763885498046875,-942.45782470703125]},{"Pos":[1120.214599609375,21.31543731689453125,-940.57373046875]},{"Pos":[1109.0279541015625,18.1374034881591796875,-933.01202392578125]},{"Pos":[1095.3157958984375,14.84785938262939453125,-933.28851318359375]},{"Pos":[1081.351318359375,10.8256893157958984375,-937.04193115234375]},{"Pos":[1067.9127197265625,8.9026088714599609375,-940.23211669921875]},{"Pos":[1064.42236328125,9.38617992401123046875,-954.65338134765625]},{"Pos":[1057.71728515625,8.4627666473388671875,-968.85357666015625]},{"Pos":[1044.562744140625,7.574239253997802734375,-962.02215576171875]},{"Pos":[1057.1766357421875,8.8702030181884765625,-983.9869384765625]},{"Pos":[1063.91259765625,7.4615688323974609375,-1001.4822998046875]},{"Pos":[1071.0303955078125,6.120086669921875,-1018.17877197265625]},{"Pos":[1083.9088134765625,4.495332241058349609375,-1029.9986572265625]},{"Pos":[1101.5081787109375,1.4874227046966552734375,-1035.84375]},{"Pos":[1113.086181640625,0.00507366657257080078125,-1037.8936767578125]},{"Pos":[1129.6312255859375,-2.1245975494384765625,-1043.9906005859375]},{"Pos":[1147.0982666015625,-4.926312923431396484375,-1047.25390625]},{"Pos":[1162.0107421875,-6.46747112274169921875,-1050.0401611328125]},{"Pos":[1175.06640625,-7.2745990753173828125,-1052.477294921875]},{"Pos":[1186.832763671875,-8.1759243011474609375,-1049.891845703125]},{"Pos":[1189.31103515625,-9.65930938720703125,-1057.5225830078125]},{"Pos":[1191.2281494140625,-9.9551982879638671875,-1070.4334716796875]},{"Pos":[1198.8658447265625,-11.26938343048095703125,-1067.923583984375]},{"Pos":[1206.6968994140625,-11.112232208251953125,-1071.332763671875]},{"Pos":[1212.059326171875,-10.6523895263671875,-1075.446533203125]},{"Pos":[1219.8365478515625,-10.6134796142578125,-1078.9649658203125]},{"Pos":[1230.541015625,-13.469081878662109375,-1079.66845703125]},{"Pos":[1239.875,-14.726154327392578125,-1076.585693359375]},{"Pos":[1179.9102783203125,-9.82978057861328125,-1074.3514404296875]},{"Pos":[1178.888916015625,-10.062103271484375,-1083.2818603515625]},{"Pos":[1180.5843505859375,-9.7785491943359375,-1089.92236328125]},{"Pos":[1177.9583740234375,-9.3295955657958984375,-1099.927490234375]},{"Pos":[1176.7216796875,-9.725475311279296875,-1109.7747802734375]},{"Pos":[1175.1441650390625,-9.55414295196533203125,-1119.4244384765625]},{"Pos":[1172.876953125,-8.693317413330078125,-1129.3753662109375]},{"Pos":[1174.197021484375,-8.10873126983642578125,-1138.5377197265625]},{"Pos":[1174.097412109375,-5.73114681243896484375,-1148.9930419921875]},{"Pos":[1170.48388671875,-4.318542003631591796875,-1159.951171875]},{"Pos":[1168.7515869140625,-1.01833343505859375,-1170.9315185546875]},{"Pos":[808.41900634765625,44.33647918701171875,-893.8011474609375]},{"Pos":[817.19854736328125,46.666339874267578125,-895.20343017578125]},{"Pos":[830.65374755859375,50.794025421142578125,-895.74969482421875]},{"Pos":[837.9061279296875,52.7488250732421875,-894.15948486328125]},{"Pos":[856.50506591796875,59.31533050537109375,-893.05657958984375]},{"Pos":[863.71954345703125,60.7754058837890625,-891.11224365234375]},{"Pos":[881.166015625,61.37584686279296875,-888.990234375]},{"Pos":[889.18963623046875,61.938846588134765625,-887.8505859375]},{"Pos":[906.55975341796875,63.69025421142578125,-886.699462890625]},{"Pos":[915.207275390625,63.301525115966796875,-885.4534912109375]},{"Pos":[922.85467529296875,63.45931243896484375,-886.22894287109375]},{"Pos":[932.47589111328125,64.10575103759765625,-882.1802978515625]},{"Pos":[940.21575927734375,64.0206298828125,-880.48956298828125]},{"Pos":[948.5106201171875,63.592479705810546875,-881.00299072265625]},{"Pos":[960.5404052734375,62.904163360595703125,-880.29205322265625]},{"Pos":[969.4390869140625,62.27886962890625,-882.831298828125]},{"Pos":[983.82830810546875,62.121166229248046875,-891.74127197265625]},{"Pos":[987.4559326171875,63.074367523193359375,-897.9566650390625]},{"Pos":[993.5819091796875,63.56053924560546875,-901.7305908203125]},{"Pos":[999.59710693359375,64.5381927490234375,-911.3193359375]},{"Pos":[1005.06488037109375,65.42903900146484375,-917.36431884765625]},{"Pos":[1008.90106201171875,67.111083984375,-924.34063720703125]},{"Pos":[1012.32037353515625,68.43286895751953125,-930.57220458984375]},{"Pos":[1019.554931640625,70.312103271484375,-938.08197021484375]},{"Pos":[1023.651123046875,71.90933990478515625,-945.5318603515625]},{"Pos":[1027.3438720703125,73.46959686279296875,-953.4100341796875]},{"Pos":[1024.2431640625,74.8647308349609375,-963.27532958984375]},{"Pos":[1022.520751953125,75.985992431640625,-968.0333251953125]},{"Pos":[1021.22589111328125,75.826019287109375,-977.7760009765625]},{"Pos":[1020.5701904296875,64.7897796630859375,-981.44757080078125]},{"Pos":[1020.5701904296875,41.198894500732421875,-981.427978515625]},{"Pos":[1020.54296875,41.795772552490234375,-974.5489501953125]},{"Pos":[1022.3092041015625,41.868305206298828125,-970.52593994140625]},{"Pos":[1030.3291015625,41.665920257568359375,-964.04638671875]},{"Pos":[1033.1644287109375,41.45548248291015625,-961.7066650390625]},{"Pos":[1039.362060546875,40.977207183837890625,-956.51116943359375]},{"Pos":[1043.0087890625,40.719104766845703125,-952.5289306640625]},{"Pos":[1049.688232421875,40.64180755615234375,-953.14044189453125]},{"Pos":[1056.9202880859375,40.556549072265625,-962.187255859375]},{"Pos":[1140.302978515625,36.150394439697265625,-1013.870849609375]},{"Pos":[1151.9664306640625,36.15038299560546875,-1017.51934814453125]},{"Pos":[1155.7716064453125,36.150390625,-1018.74853515625]},{"Pos":[1164.1590576171875,35.55039215087890625,-1019.39251708984375]},{"Pos":[1167.6524658203125,34.99091339111328125,-1012.7928466796875]},{"Pos":[1168.12255859375,34.57543182373046875,-1009.7769775390625]},{"Pos":[1168.90625,33.891277313232421875,-1002.83111572265625]},{"Pos":[1168.6060791015625,33.610691070556640625,-999.4215087890625]},{"Pos":[1168.4835205078125,33.2264556884765625,-992.183837890625]},{"Pos":[1165.7657470703125,31.7157115936279296875,-981.94873046875]},{"Pos":[1163.98828125,30.876926422119140625,-977.9404296875]},{"Pos":[1161.0048828125,29.628261566162109375,-969.43975830078125]},{"Pos":[1158.8681640625,29.3795719146728515625,-966.395751953125]},{"Pos":[1153.723388671875,28.6888675689697265625,-961.0902099609375]},{"Pos":[1150.326904296875,27.3338184356689453125,-958.10845947265625]},{"Pos":[1144.2684326171875,25.5088100433349609375,-951.0809326171875]},{"Pos":[1141.9710693359375,25.2532501220703125,-948.82080078125]},{"Pos":[1138.911865234375,24.60028839111328125,-945.54052734375]},{"Pos":[1131.155029296875,23.1468830108642578125,-941.2332763671875]},{"Pos":[1127.4775390625,21.8604564666748046875,-940.86114501953125]},{"Pos":[1123.823974609375,21.5391216278076171875,-940.44085693359375]},{"Pos":[1117.9415283203125,20.946125030517578125,-938.73956298828125]},{"Pos":[1114.8262939453125,20.2468624114990234375,-936.81524658203125]},{"Pos":[1111.794921875,19.3181705474853515625,-935.1025390625]},{"Pos":[1106.4322509765625,17.515377044677734375,-932.8199462890625]},{"Pos":[1103.093017578125,17.2356719970703125,-932.96319580078125]},{"Pos":[1099.42919921875,16.4960422515869140625,-932.82745361328125]},{"Pos":[1091.7012939453125,13.14619159698486328125,-934.8585205078125]},{"Pos":[1088.9075927734375,12.29616641998291015625,-936.03265380859375]},{"Pos":[1085.2701416015625,11.46599864959716796875,-937.31768798828125]},{"Pos":[1077.8092041015625,10.2102031707763671875,-938.02032470703125]},{"Pos":[1074.90966796875,9.572460174560546875,-939.22735595703125]},{"Pos":[1071.463134765625,8.9193210601806640625,-939.88470458984375]},{"Pos":[1066.767822265625,8.92127132415771484375,-943.58349609375]},{"Pos":[1066.34375,9.05749034881591796875,-947.2027587890625]},{"Pos":[1065.172607421875,9.3040313720703125,-950.77362060546875]},{"Pos":[1062.7449951171875,9.29520511627197265625,-958.17193603515625]},{"Pos":[1060.8599853515625,9.03893375396728515625,-961.31622314453125]},{"Pos":[1059.574951171875,8.75251483917236328125,-965.1158447265625]},{"Pos":[1056.9052734375,8.347179412841796875,-972.6683349609375]},{"Pos":[1056.93896484375,8.20335865020751953125,-975.85107421875]},{"Pos":[1056.879638671875,8.20769023895263671875,-980.6231689453125]},{"Pos":[1053.8375244140625,8.25549411773681640625,-966.53704833984375]},{"Pos":[1050.5164794921875,8.1004009246826171875,-964.82958984375]},{"Pos":[1047.0850830078125,7.8102283477783203125,-963.535888671875]},{"Pos":[1040.7042236328125,7.46768283843994140625,-961.59490966796875]},{"Pos":[1037.5343017578125,7.52647304534912109375,-962.39141845703125]},{"Pos":[1033.0849609375,7.712458133697509765625,-963.880859375]},{"Pos":[1029.870361328125,8.14809131622314453125,-965.2393798828125]},{"Pos":[1026.515380859375,8.2272281646728515625,-966.65802001953125]},{"Pos":[1023.370361328125,7.834770679473876953125,-967.98638916015625]},{"Pos":[1019.9075927734375,7.727566242218017578125,-969.4501953125]},{"Pos":[1016.2698974609375,7.3761081695556640625,-970.98907470703125]},{"Pos":[1012.8861083984375,7.365779876708984375,-972.41949462890625]},{"Pos":[1009.5291748046875,7.477801799774169921875,-973.83856201171875]},{"Pos":[1006.1212158203125,7.442379474639892578125,-975.2794189453125]},{"Pos":[1003.0970458984375,7.575438976287841796875,-976.55718994140625]},{"Pos":[1000.2015380859375,7.936963558197021484375,-977.78082275390625]},{"Pos":[999.69647216796875,7.6243133544921875,-981.412841796875]},{"Pos":[995.88397216796875,8.1347942352294921875,-977.48931884765625]},{"Pos":[991.30120849609375,8.0019054412841796875,-976.97412109375]},{"Pos":[1015.0107421875,7.494969844818115234375,-966.79443359375]},{"Pos":[1013.76092529296875,7.789839267730712890625,-963.70892333984375]},{"Pos":[1012.28045654296875,7.989983081817626953125,-959.8614501953125]},{"Pos":[1011.01446533203125,8.5615024566650390625,-956.56561279296875]},{"Pos":[1066.1593017578125,9.16228485107421875,-937.3453369140625]},{"Pos":[1058.4141845703125,9.5467243194580078125,-988.5462646484375]},{"Pos":[1059.484375,9.0621776580810546875,-991.41510009765625]},{"Pos":[1061.5921630859375,8.30164623260498046875,-995.9755859375]},{"Pos":[1065.289306640625,7.20876312255859375,-1004.7706298828125]},{"Pos":[1066.6219482421875,6.93354034423828125,-1008.30316162109375]},{"Pos":[1067.9754638671875,6.6407337188720703125,-1011.8895263671875]},{"Pos":[1069.806640625,6.4590606689453125,-1014.99066162109375]},{"Pos":[1073.6920166015625,5.87235736846923828125,-1021.0416259765625]},{"Pos":[1076.162841796875,5.853043079376220703125,-1022.9564208984375]},{"Pos":[1079.8150634765625,5.361815929412841796875,-1024.6226806640625]},{"Pos":[1081.6839599609375,4.99903106689453125,-1027.2032470703125]},{"Pos":[1087.1444091796875,4.10911464691162109375,-1030.6343994140625]},{"Pos":[1090.180908203125,3.8727056980133056640625,-1032.0142822265625]},{"Pos":[1093.873779296875,3.39640045166015625,-1033.679443359375]},{"Pos":[1097.08154296875,2.73522472381591796875,-1035.12548828125]},{"Pos":[1104.3399658203125,1.10549414157867431640625,-1036.350830078125]},{"Pos":[1108.2169189453125,0.5702359676361083984375,-1036.6864013671875]},{"Pos":[1116.0072021484375,-0.31356918811798095703125,-1037.6832275390625]},{"Pos":[1119.7978515625,-0.76465260982513427734375,-1039.374755859375]},{"Pos":[1123.6514892578125,-1.2485411167144775390625,-1041.1160888671875]},{"Pos":[1126.2255859375,-1.619177341461181640625,-1043.2537841796875]},{"Pos":[1133.676025390625,-2.8109581470489501953125,-1044.8868408203125]},{"Pos":[1136.9425048828125,-3.376162052154541015625,-1045.7498779296875]},{"Pos":[1141.2689208984375,-3.9878597259521484375,-1046.3182373046875]},{"Pos":[1144.134765625,-4.16854381561279296875,-1047.034912109375]},{"Pos":[1151.3936767578125,-5.280669689178466796875,-1047.6898193359375]},{"Pos":[1155.1220703125,-5.1027984619140625,-1048.7457275390625]},{"Pos":[1159.04345703125,-5.7859783172607421875,-1049.69287109375]},{"Pos":[1166.6051025390625,-6.4496097564697265625,-1050.58984375]},{"Pos":[1170.3992919921875,-6.581037998199462890625,-1051.6082763671875]},{"Pos":[1179.043701171875,-7.695218563079833984375,-1051.452880859375]},{"Pos":[1182.4554443359375,-7.8641204833984375,-1050.4862060546875]},{"Pos":[1188.183349609375,-9.183734893798828125,-1052.8843994140625]},{"Pos":[1191.3148193359375,-10.0033626556396484375,-1059.5732421875]},{"Pos":[1193.810791015625,-10.6266231536865234375,-1061.7177734375]},{"Pos":[1196.517333984375,-10.9547557830810546875,-1064.746337890625]},{"Pos":[1201.5697021484375,-11.29963970184326171875,-1069.080810546875]},{"Pos":[1204.0904541015625,-11.13423633575439453125,-1070.0692138671875]},{"Pos":[1205.401611328125,-11.1928272247314453125,-1067.9771728515625]},{"Pos":[1197.654296875,-10.79209136962890625,-1070.302978515625]},{"Pos":[1195.338134765625,-10.19498729705810546875,-1073.4066162109375]},{"Pos":[1187.7523193359375,-9.92063426971435546875,-1071.1123046875]},{"Pos":[1184.846923828125,-9.79413604736328125,-1071.163330078125]},{"Pos":[1181.9954833984375,-9.72338104248046875,-1071.6636962890625]},{"Pos":[1178.641845703125,-9.97222995758056640625,-1077.4267578125]},{"Pos":[1178.9935302734375,-10.0766735076904296875,-1080.1375732421875]},{"Pos":[1179.55078125,-9.95277500152587890625,-1085.384521484375]},{"Pos":[1179.7742919921875,-9.38921833038330078125,-1093.750244140625]},{"Pos":[1178.854248046875,-9.27609729766845703125,-1096.62109375]},{"Pos":[1177.660888671875,-9.47092151641845703125,-1102.875732421875]},{"Pos":[1177.1546630859375,-9.6274013519287109375,-1106.0794677734375]},{"Pos":[1176.3153076171875,-9.68860530853271484375,-1112.486328125]},{"Pos":[1175.8936767578125,-9.61155223846435546875,-1115.3377685546875]},{"Pos":[1174.804443359375,-9.2654857635498046875,-1122.4991455078125]},{"Pos":[1174.0574951171875,-9.0097026824951171875,-1125.4029541015625]},{"Pos":[1172.5611572265625,-8.533596038818359375,-1132.408447265625]},{"Pos":[1173.424560546875,-8.48211574554443359375,-1134.893310546875]},{"Pos":[1174.0234375,-7.40042781829833984375,-1141.4053955078125]},{"Pos":[1174.32666015625,-6.39013957977294921875,-1145.2889404296875]},{"Pos":[1173.0892333984375,-5.446883678436279296875,-1151.9833984375]},{"Pos":[1171.882568359375,-5.2377300262451171875,-1155.3428955078125]},{"Pos":[1169.4697265625,-3.4458415508270263671875,-1163.082275390625]},{"Pos":[1168.65869140625,-2.74664783477783203125,-1166.2742919921875]},{"Pos":[1169.154541015625,-1.7098505496978759765625,-1169.205078125]},{"Pos":[1194.3995361328125,-10.1541805267333984375,-1070.3062744140625]},{"Pos":[1209.4366455078125,-10.839252471923828125,-1073.500244140625]},{"Pos":[1214.688720703125,-10.53351497650146484375,-1076.638671875]},{"Pos":[1217.0859375,-10.598697662353515625,-1077.495849609375]},{"Pos":[1223.3465576171875,-11.80687713623046875,-1079.73486328125]},{"Pos":[1227.1593017578125,-13.10635280609130859375,-1079.6927490234375]},{"Pos":[1225.722412109375,-12.273181915283203125,-1083.7158203125]},{"Pos":[1234.3299560546875,-14.8402233123779296875,-1078.5384521484375]},{"Pos":[1236.5069580078125,-14.82780551910400390625,-1077.6392822265625]},{"Pos":[1242.71826171875,-15.7451171875,-1076.3382568359375]},{"Pos":[1246.7747802734375,-16.9475498199462890625,-1076.8341064453125]},{"Pos":[1251.361083984375,-17.2211437225341796875,-1077.3199462890625]},{"Pos":[1255.462890625,-16.8514270782470703125,-1079.42138671875]},{"Pos":[1257.3253173828125,-16.2378082275390625,-1082.2357177734375]},{"Pos":[1259.3189697265625,-15.6821269989013671875,-1085.470458984375]},{"Pos":[1261.4896240234375,-15.67748355865478515625,-1087.9447021484375]},{"Pos":[1263.9154052734375,-15.7871685028076171875,-1090.6611328125]},{"Pos":[1266.108642578125,-15.85834980010986328125,-1093.1158447265625]},{"Pos":[1268.2335205078125,-15.6539707183837890625,-1095.4913330078125]},{"Pos":[1270.32666015625,-14.05170345306396484375,-1097.8251953125]},{"Pos":[1268.149169921875,-14.0217990875244140625,-1100.5543212890625]},{"Pos":[1266.589111328125,-13.70142078399658203125,-1103.1322021484375]},{"Pos":[1266.398681640625,-13.1768245697021484375,-1106.399658203125]},{"Pos":[1266.21435546875,-12.70769500732421875,-1109.7347412109375]},{"Pos":[1267.353515625,-12.3170490264892578125,-1112.41259765625]},{"Pos":[1267.2205810546875,-11.40529537200927734375,-1115.8475341796875]},{"Pos":[1268.884033203125,-10.27731037139892578125,-1118.3968505859375]},{"Pos":[1271.1044921875,-9.65346813201904296875,-1120.875732421875]},{"Pos":[1273.0184326171875,-8.9764232635498046875,-1123.0101318359375]},{"Pos":[1164.125244140625,32.9832916259765625,-991.83831787109375]},{"Pos":[1160.30615234375,32.541900634765625,-990.7471923828125]},{"Pos":[1171.5169677734375,34.57958221435546875,-1011.0306396484375]},{"Pos":[1162.666259765625,35.58013916015625,-1023.94293212890625]},{"Pos":[1164.7000732421875,35.550380706787109375,-1026.6712646484375]},{"Pos":[1167.1314697265625,35.550380706787109375,-1029.96533203125]},{"Pos":[1169.3988037109375,35.550380706787109375,-1033.0350341796875]},{"Pos":[1170.8912353515625,35.573467254638671875,-1036.0823974609375]},{"Pos":[1171.765869140625,36.036876678466796875,-1039.494873046875]},{"Pos":[1171.2666015625,36.536258697509765625,-1042.92138671875]},{"Pos":[1171.9207763671875,36.7573089599609375,-1046.0582275390625]},{"Pos":[1171.4078369140625,36.936893463134765625,-1049.53466796875]},{"Pos":[1171.148193359375,37.355007171630859375,-1052.8505859375]},{"Pos":[1172.375,37.350391387939453125,-1056.1424560546875]},{"Pos":[1172.7059326171875,37.34467315673828125,-1058.94482421875]},{"Pos":[1173.1119384765625,37.35037994384765625,-1062.3717041015625]},{"Pos":[1173.5118408203125,37.35037994384765625,-1065.748779296875]},{"Pos":[1173.8604736328125,37.35037994384765625,-1068.69970703125]},{"Pos":[1174.2467041015625,37.35037994384765625,-1071.9688720703125]},{"Pos":[1174.6090087890625,37.35265350341796875,-1075.0355224609375]},{"Pos":[1174.9644775390625,37.369853973388671875,-1078.0443115234375]},{"Pos":[1175.3677978515625,37.375026702880859375,-1081.4581298828125]},{"Pos":[1175.730712890625,37.363193511962890625,-1084.765380859375]},{"Pos":[1175.4691162109375,37.37717437744140625,-1087.6964111328125]},{"Pos":[1174.546875,37.42693328857421875,-1090.5023193359375]},{"Pos":[1173.67333984375,37.582195281982421875,-1093.3154296875]},{"Pos":[1173.055419921875,37.37703704833984375,-1096.1790771484375]},{"Pos":[1172.58154296875,37.47389984130859375,-1098.86279296875]},{"Pos":[1172.10791015625,37.516872406005859375,-1101.8162841796875]},{"Pos":[1171.33544921875,37.49065399169921875,-1104.4307861328125]},{"Pos":[1170.4088134765625,37.371501922607421875,-1107.23876953125]},{"Pos":[1169.62841796875,37.23027801513671875,-1110.2894287109375]},{"Pos":[1168.995849609375,37.133892059326171875,-1113.1124267578125]},{"Pos":[1168.2325439453125,37.075046539306640625,-1116.020263671875]},{"Pos":[1167.6253662109375,37.107379913330078125,-1118.9080810546875]},{"Pos":[1167.7650146484375,37.202342987060546875,-1122.264404296875]},{"Pos":[1167.974853515625,37.33966064453125,-1125.605224609375]},{"Pos":[1169.90478515625,37.3831939697265625,-1128.0289306640625]},{"Pos":[1171.380615234375,37.412353515625,-1131.15087890625]},{"Pos":[1172.634033203125,37.43189239501953125,-1133.8681640625]},{"Pos":[1173.479736328125,37.455806732177734375,-1136.543701171875]},{"Pos":[1173.705810546875,37.455135345458984375,-1139.42919921875]},{"Pos":[1173.6334228515625,37.367168426513671875,-1142.617431640625]},{"Pos":[1172.6475830078125,37.27594757080078125,-1145.4898681640625]},{"Pos":[1169.884033203125,37.141147613525390625,-1147.690185546875]}]]=])

	local function ApplyModifiers(bool)
		for i,v in pairs(PathModifiers) do
			if v.Instance then
				v.Instance:Destroy()
			end
		end
		for i,v in pairs(PathTemplate) do
			if v.Instance then
				v.Instance:Destroy()
			end
		end

		if bool then
			for i,v in pairs(PathModifiers) do
				local part = Instance.new("Part")
				part.Anchored = true
				part.CanCollide = true
				part.Size = v.Size
				part.Position = v.Position
				part.Orientation = v.Orientation
				--part.Transparency = 1
				part.Parent = workspace
				v.Instance = part
			end
			for i,v in pairs(PathTemplate) do
				local part = Instance.new("Part")
				part.Anchored = true
				part.CanCollide = false
				part.Size = Vector3.new(2,2,2)
				part.Position = Vector3.new(unpack(v.Pos))
				--part.Transparency = 1
				part.Parent = workspace
				part.Material = "Neon"
				v.Instance = part
			end
		end
	end

	local function NavigateTo(pos)
		if not Settings.AutoMine.Enabled or (plr.Character.PrimaryPart.Position - pos).magnitude < 10 then
			return true
		end

		local path = game.PathfindingService:CreatePath({
			WaypointSpacing = 20,
			AgentRadius = 3,
			Costs = {
				Water = math.huge,
				Neon = -999999
			}
		})
		local t = tick()
		debugwarn("computing")
		ApplyModifiers(true)
		local s,e = pcall(path.ComputeAsync, path, plr.Character.PrimaryPart.Position, pos)
		ApplyModifiers(false)
		debugwarn("computed! took", tick() - t)

		if not s then
			debugwarn(e)
			return false
		end

		if path.Status == Enum.PathStatus.Success then
			local nodes = {}
			local waypoints = path:GetWaypoints()

			local badWaypoints = 0
			for i,v in pairs(waypoints) do
				local nextWaypoint = waypoints[i + 1]
				if nextWaypoint then
					local ray = Ray.new(v.Position, (nextWaypoint.Position - v.Position).Unit * (nextWaypoint.Position - v.Position).Magnitude)
					local hit, pos = workspace:FindPartOnRayWithWhitelist(ray, {workspace.Terrain})
					if hit and (pos - v.Position).magnitude > 2 then
						if waypoints[i + 2] and math.abs(pos.Y - waypoints[i + 2].Position.Y) < math.abs(pos.Y - v.Position.Y) then
							waypoints[i + 1] = {
								Position = Vector3.new(nextWaypoint.Position.X, pos.Y, nextWaypoint.Position.Z),
							}
							debugprint("fixed a bad waypoint")
						else
							badWaypoints = badWaypoints + 1
						end
					end
				end
			end

			debugwarn(badWaypoints, "bad waypoints")
			if badWaypoints > 0 then
				--return false
			end

			for i,v in pairs(waypoints) do
				local p = Instance.new("Part")
				p.Anchored = true
				p.CanCollide = false
				p.BrickColor = BrickColor.White()
				p.Shape = "Ball"
				p.Material = "Neon"
				p.Size = Vector3.new(2,2,2)
				p.CFrame = CFrame.new(v.Position)
				p.Parent = workspace
				p.Name = "Waypoint_" .. i
				nodes[i] = p

				if i ~= 1 then
					local new = Instance.new("Part")
					new.Anchored = true
					new.CanCollide = false
					new.Material = "Neon"
					new.BrickColor = BrickColor.Blue()
					new.Size = Vector3.new(0.5,0.5,(v.Position - waypoints[i - 1].Position).magnitude)
					new.CFrame = CFrame.new(v.Position, waypoints[i - 1].Position) * CFrame.new(0,0,-(v.Position - waypoints[i - 1].Position).magnitude/2)
					new.Parent = workspace
					nodes[i .. "-" .. i-1] = new
				end
			end

			for i,v in pairs(waypoints) do
				MoveTo(v.Position)
				nodes[i].BrickColor = BrickColor.Yellow()
				if timedOutInARow >= 4 then
					return true
				end
			end

			for i,v in pairs(nodes) do
				v:Destroy()
			end
			return true
		else
			debugwarn("didn't find", path.Status)
			return false
		end
	end

	--[[
		local t = require(game.ReplicatedStorage:WaitForChild("SharedModules"):WaitForChild("Global")).PlayerCharacter:GetEquippedItem()
		--print(t.SharedData.Tier)

		local a = require(game.ReplicatedStorage:WaitForChild("SharedModules"):WaitForChild("Global")).PlayerData:GetContainer("Inventory")
		table.foreach(a.Items[3], print)
	]]

	if isDebug then
		UiTbl.autoMineGroup:CheckBox("Enabled", function(bool)
			Settings.AutoMine.Enabled = bool

			timedOutInARow = 0
			while Settings.AutoMine.Enabled do
				SharedModules.PlayerCharacter.IsSprintButtonDown = true
				for i,v in pairs(GetOres()) do
					if NavigateTo(v.PrimaryPart.Position) then
						SharedModules.PlayerCharacter:GetEquippedItem().IsActivated = true
						break
					else
						SharedModules.PlayerCharacter:GetEquippedItem().IsActivated = false
					end
				end
				wait()
			end
			SharedModules.PlayerCharacter:GetEquippedItem().IsActivated = false
		end)
	end
	
	UiTbl.weapons = NewUI:Tab("Weapons", {
		Width = 230,
	})

	UiTbl.aimGroup = UiTbl.weapons:Group('Silent aim')
	UiTbl.modsGroup = UiTbl.weapons:Group('Weapon mods')
	UiTbl.wlGroup = UiTbl.weapons:Group('Aim whitelist')

	-- UiTbl.aimGroup = UiTbl.weapons:Group("Silent Aim")
	-- UiTbl.modsGroup = UiTbl.weapons:Group("Weapon Mods")
	-- UiTbl.wlGroup = UiTbl.weapons:Group("Aim Whitelist")

	UiTbl.aimGroup:CheckBox("Silent aim", function(bool)
		Settings.SilentAim = bool
		ESP.HighlightEnabled = bool

		if not bool then
			ESP.Highlighted = nil
		end
	end, "SilentAim"):Keybind(Enum.KeyCode.E, "SilentAim")

	markAsUnsafe(UiTbl.aimGroup:CheckBox('Backtrack', function(bool) Settings.BackTrack = bool end, 'BackTrack'))
	markAsUnsafe(UiTbl.aimGroup:CheckBox('Wallbang', function(bool) Settings.WallBang = bool end, 'WallBang'))
	
	UiTbl.aimGroup:Label('Aimbot settings')

	UiTbl.aimGroup:CheckBox("Visibility check", function(bool)
		Settings.VisCheck = bool
		Aimbot.VisCheck = bool
	end, "VisCheck").Click()

	UiTbl.aimGroup:Dropdown({
		Text = "Aim part",
		Values = { "Head", "Torso" },
		Radio = true,
		Default = 1
	}, function(val)
		Aimbot.AimPart = val
	end, "AimPart")

	UiTbl.aimGroup:CheckBox('Target players', function(bool) Settings.SilentTargetPlayers = bool end, 'SilentTargetPlayers').Click()
	UiTbl.aimGroup:CheckBox('Target animals', function(bool) Settings.SilentTargetAnimals = bool end, 'SilentTargetAnimals')
	UiTbl.aimGroup:CheckBox('Target NPCs', 	function(bool) Settings.SilentTargetNPCs = bool end, 'SilentTargetNPCs')

	UiTbl.aimGroup:Dropdown({
		Text = "Target priority",
		Values = { "Players", "Animals", 'NPCs' },
		Radio = true,
		Default = 1
	}, function(val)
		Settings.TargetPriority = val
	end, "TargetPriority")

	UiTbl.aimGroup:CheckBox("Respect Friendly\nMode", function(bool)
		Settings.FriendlyCheck = bool
	end, "FriendlyCheck"):SetMultiLine()

	UiTbl.aimGroup:CheckBox("Ignore Faction Members", function(bool)
		Settings.FactionCheck = bool
	end, "FactionCheck")

	local FOVCircle = ESP.FOVCircle(Settings.FOVRange)
	UiTbl.aimGroup:Slider({
		Min = 0,
		Max = ESP.GetFOV(),
		Default = 200,
		Parent = UiTbl.aimGroup:CheckBox("Show FOV Circle", function(bool)
			Settings.ShowFOVCircle = bool
			if bool then
				FOVCircle.Tbl.Update = FOVCircle.Update
				FOVCircle.Drawing.Visible = true
			else
				FOVCircle.Tbl.Update = nil
				FOVCircle.Drawing.Visible = false
			end
		end, "ShowFOVCircle")
	}, function(val)
		Settings.FOVRange = val
		Settings.UsedFOVRange = val
		if FOVCircle.Drawing then
			FOVCircle.Drawing.Radius = val
		end
		return "FOV Range: " .. val
	end, "FOVRange")

	UiTbl.aimGroup:Label("Max Distance")
	UiTbl.aimGroup:Slider({
		Min = 0,
		Max = 1500,
		Default = 500
	}, function(val)
		Settings.AimDistance = val
		return val .. ""
	end, "AimDistance")
	
	UiTbl.aimGroup:Label("Headshot Chance")
	UiTbl.aimGroup:Slider({
		Min = 0,
		Max = 100,
		Default = 100
	}, function(val)
		Settings.HeadshotChance = val
		return val .. "%"
	end, "HeadshotChance")
	

	UiTbl.modsGroup:CheckBox("No Recoil", function(bool)
		Settings.NoRecoil = bool
	end, "NoRecoil")

	UiTbl.modsGroup:CheckBox("No Spread", function(bool)
		Settings.NoSpread = bool
	end, "NoSpread")

	UiTbl.modsGroup:Slider({
		Min = 1,
		Max = 3.5,
		Default = 1,
		Fraction = 1,

		Parent = markAsUnsafe(UiTbl.modsGroup:CheckBox('Fast Reload', function(bool)
			Settings.NoReload = bool
		end, 'NoReload')),
	}, function(value)
		Settings.ReloadScale = value
		
		return 'Reload scale: ' .. string.format('%d%%', 100 * value)
		--return string.format('Reload scale: %s%%', 100 * value)
	end, 'ReloadScale')

	UiTbl.modsGroup:CheckBox('Use headshot sound', function(bool)
		Settings.CustomHeadshotSound = bool
	end, 'UseCustomHeadshotSound')


	UiTbl.modsGroup:Dropdown({
		Text = 'Headshot Sound',
		Values = { 'Rust', 'Skeet', 'Custom' },
		Radio = true,
		Default = 1,
	}, function(val)
		Settings.HeadShotSound = val
	end, 'HeadShotSound')

	UiTbl.modsGroup:TextBox({
		PlaceholderText = "Headshot Sound Id"
	}, function(text, enter, input, autoLoad)
		Settings.CustomHeadshotSoundId = text
	end, 'CustomHeadshotSoundId') 

	UiTbl.wlList = UiTbl.wlGroup:List({
		Height = 90,
		NoPadding = true
	})
	
	local baseUrl = 'https://games.roblox.com/v1/games/%s/servers/public?cursor=%s&limit=100'
	local function findServer(id, history, mode)
		local cursor = ''
		local servers = {}

		while true do
			local s, list = pcall(HttpGet, baseUrl:format(game.PlaceId, cursor))

			while not s do
				wait(0.1)
				s, list = pcall(HttpGet, baseUrl:format(game.PlaceId, cursor))
			end

			local s, decoded = pcall(function() return game:GetService("HttpService"):JSONDecode(list) end)
			if s then
				for k, v in next, decoded.data do
					if type(v.playing) == 'number' and type(v.maxPlayers) == 'number' and type(v.id) == 'string' then -- some weird edge case .. ???????
						if v.playing < v.maxPlayers then 
							if (not table.find(history, v.id)) then
								servers[#servers + 1] = v
							else
								debugprint('ignoring', v.id)
							end
						end
					end
				end
	
				cursor = decoded.nextPageCursor
				if not cursor then break end
			end
			
		end

		local server
		if mode == 'smallest' then
			table.sort(servers, function(a, b) return a.playing < b.playing end)
			server = servers[1]
		else
			server = table.remove(servers, Random.new():NextInteger(1, #servers))
		end

		if mode == 'hop' then
			SetTPSetting('KHFindLegendaryServer', true)
			SetTPSetting('KHServerHop', history)
		end

		if id:len() > 1 then
			debugprint('Id override', id)
			server = { id = id }
		end

		game:GetService('TeleportService'):TeleportToPlaceInstance(game.PlaceId, server.id)
	end

	local function serverHop(id)
		local ignore = GetTPSetting('KHServerHop') or {}
		if not table.find(ignore, game.JobId) then
			table.insert(ignore, game.JobId)
		end
		return findServer(id or '', ignore, 'hop')
	end

	local function beep()
		local sound = Instance.new('Sound')

		sound.Pitch = 1;
		sound.Volume = 10;
		
		sound.SoundId = 'rbxassetid://138081500'

		syn.protect_gui(sound)
		sound.Parent = game:GetService('CoreGui')
	    sound:Play()
	end

	local function SendEmbed(webhookUrl, text, embed)
		return pcall(request, {
			Url = webhookUrl,
			Method = "POST",
			Headers = {
				["Content-Type"] = "application/json"
			},
			Body = game.HttpService:JSONEncode({
				content = text,
				embeds = {embed}
			})
		})
	end

	UiTbl.serverTab = NewUI:Tab("Server", {
		Width = 230,
	})

	UiTbl.finderGroup = UiTbl.serverTab:Group('Server Hop')
	UiTbl.tpFiltersGroup = UiTbl.serverTab:Group('Filters')
	UiTbl.tpOptionsGroup = UiTbl.serverTab:Group('Options')
	UiTbl.serverStatsGroup = UiTbl.serverTab:Group('Server stats')

	UiTbl.legendaryCountLabel = UiTbl.serverStatsGroup:Label('Legendary animals: 0')
	UiTbl.thunderstruckCountLabel = UiTbl.serverStatsGroup:Label('Thunderstruck count: 0')

	local history = GetTPSetting('KHServerHop') or {}
	UiTbl.finderGroup:Button('Rejoin', function()
		game:GetService('TeleportService'):TeleportToPlaceInstance(game.PlaceId, game.JobId)
	end)
	
	UiTbl.finderGroup:Button('Join new server', function()
		findServer('', { game.JobId }, 'new')
	end)

	UiTbl.finderGroup:Button('Join smallest server', function()
		findServer('', { game.JobId }, 'smallest')
	end)

	--[[UiTbl.finderGroup:Button('Join debug server', function()
		serverHop'697c2856-b208-4bf5-aa2a-9331b13d1c8d'
	end)]]

	UiTbl.finderGroup:Button('Server hop', function()
		if (not GetTPSetting('KHThunderstruckObjects')) and (not GetTPSetting('KHLegendaryAnimals')) and (not GetTPSetting('KHFactionFinder')) then
			return messagebox("Please select at least 1 type of item to search for.", "[KiriotHub]", 0x00040000 + 0x00001000 + 0x00010000)
		end
		serverHop()
	end)

	UiTbl.finderGroup:Button('Clear server history', function()  
		SetTPSetting('KHServerHop', {})
		UiTbl.serverHistoryLabel.LabelObj.Text = 'Server history: 0'
	end)

	local debounce = false
	UiTbl.tpOptionsGroup:TextBox({
		PlaceholderText = "Server Hop Webhook"
	}, function(text, enter, obj, autoLoad)
		debugprint('registred link')
		Settings.WWHopWebhook = text
		if (not autoLoad) and enter and (not debounce) then
			-- stupid hack bc kiriot calls .Callback twice for w/e reason?
			debounce = true
			task.spawn(function() task.wait(0.5) debounce = false end)
			SendEmbed(text, nil, {
				title = "Wild West Server Hop",
				color = 14451283,
				timestamp = os.date("%Y-%m%dT%H:%M:%S", os.time(os.date("!*t"))),
				description = "Your webhook works, wooooooooooooo!",
				footer = {
					icon_url = "https://buy.kiriothub.today/icon.png",
					text = "KiriotHub"
				},
			})
		end
	end, 'WWHopWebhook')

	UiTbl.tpFiltersGroup:CheckBox('Legendary animals', function(bool) SetTPSetting('KHLegendaryAnimals', bool) end, 'KHLegendaryAnimals')
	UiTbl.tpFiltersGroup:CheckBox('Thunderstruck', function(bool) SetTPSetting('KHThunderstruckObjects', bool) end, 'KHThunderstruckObjects')
	UiTbl.tpFiltersGroup:CheckBox('Faction finder', function(bool) SetTPSetting('KHFactionFinder', bool) end, 'KHFacti... (66 KB left)
